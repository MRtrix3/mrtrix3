mkdir -p ../tmp/dwibiascorrect/ants && mrconvert BIDS/sub-01/dwi/sub-01_dwi.nii.gz -fslgrad BIDS/sub-01/dwi/sub-01_dwi.bvec BIDS/sub-01/dwi/sub-01_dwi.bval tmp-sub-01_dwi.mif -export_grad_mrtrix tmp-sub-01_dwi.b -strides 0,0,0,1 && dwibiascorrect ants tmp-sub-01_dwi.mif ../tmp/dwibiascorrect/ants/default_out.mif -bias ../tmp/dwibiascorrect/ants/default_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/ants/default_out.mif dwibiascorrect/ants/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/ants/default_bias.mif dwibiascorrect/ants/default_bias.mif.gz
dwibiascorrect ants BIDS/sub-01/dwi/sub-01_dwi.nii.gz -fslgrad BIDS/sub-01/dwi/sub-01_dwi.bvec BIDS/sub-01/dwi/sub-01_dwi.bval ../tmp/dwibiascorrect/ants/fslgrad_out.mif -bias ../tmp/dwibiascorrect/ants/fslgrad_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/ants/fslgrad_out.mif dwibiascorrect/ants/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/ants/fslgrad_bias.mif dwibiascorrect/ants/default_bias.mif.gz
dwibiascorrect ants BIDS/sub-01/dwi/sub-01_dwi.nii.gz -grad tmp-sub-01_dwi.b ../tmp/dwibiascorrect/ants/grad_out.mif -bias ../tmp/dwibiascorrect/ants/grad_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/ants/grad_out.mif dwibiascorrect/ants/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/ants/grad_bias.mif dwibiascorrect/ants/default_bias.mif.gz
dwibiascorrect ants tmp-sub-01_dwi.mif ../tmp/dwibiascorrect/ants/masked_out.mif -bias ../tmp/dwibiascorrect/ants/masked_bias.mif -mask BIDS/sub-01/dwi/sub-01_brainmask.nii.gz -force && testing_diff_header ../tmp/dwibiascorrect/ants/masked_out.mif dwibiascorrect/ants/masked_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/ants/masked_bias.mif dwibiascorrect/ants/masked_bias.mif.gz
mkdir -p ../tmp/dwibiascorrect/fsl && dwibiascorrect fsl tmp-sub-01_dwi.mif ../tmp/dwibiascorrect/fsl/default_out.mif -bias ../tmp/dwibiascorrect/fsl/default_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/fsl/default_out.mif dwibiascorrect/fsl/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/fsl/default_bias.mif dwibiascorrect/fsl/default_bias.mif.gz
dwibiascorrect fsl BIDS/sub-01/dwi/sub-01_dwi.nii.gz -fslgrad BIDS/sub-01/dwi/sub-01_dwi.bvec BIDS/sub-01/dwi/sub-01_dwi.bval ../tmp/dwibiascorrect/fsl/fslgrad_out.mif -bias ../tmp/dwibiascorrect/fsl/fslgrad_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/fsl/fslgrad_out.mif dwibiascorrect/fsl/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/fsl/fslgrad_bias.mif dwibiascorrect/fsl/default_bias.mif.gz
dwibiascorrect fsl BIDS/sub-01/dwi/sub-01_dwi.nii.gz -grad tmp-sub-01_dwi.b ../tmp/dwibiascorrect/fsl/grad_out.mif -bias ../tmp/dwibiascorrect/fsl/grad_bias.mif -force && testing_diff_header ../tmp/dwibiascorrect/fsl/grad_out.mif dwibiascorrect/fsl/default_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/fsl/grad_bias.mif dwibiascorrect/fsl/default_bias.mif.gz
dwibiascorrect fsl tmp-sub-01_dwi.mif ../tmp/dwibiascorrect/fsl/masked_out.mif -bias ../tmp/dwibiascorrect/fsl/masked_bias.mif -mask BIDS/sub-01/dwi/sub-01_brainmask.nii.gz -force && testing_diff_header ../tmp/dwibiascorrect/fsl/masked_out.mif dwibiascorrect/fsl/masked_out.mif.gz && testing_diff_header ../tmp/dwibiascorrect/fsl/masked_bias.mif dwibiascorrect/fsl/masked_bias.mif.gz
