# run legacy:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp/ -cfe_legacy -force
# check outputs:
( for f in abs_effect.mif beta0.mif beta1.mif std_dev.mif std_effect.mif tvalue.mif; do testing_diff_image tmp/$f fixelcfestats/legacy/$f -abs 1e-6 || exit 1; done ) && mrcalc tmp/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif -abs 1e-6

# run default:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp/ -force
# check outputs:
( for f in abs_effect.mif beta0.mif beta1.mif cfe.mif std_dev.mif std_effect.mif tvalue.mif Zstat.mif; do testing_diff_image tmp/$f fixelcfestats/default/$f -abs 1e-6 || exit 1; done ) && mrcalc tmp/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif -abs 1e-6

# run masked:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp/ -mask SIFT_phantom/fixels/upper.mif -force
# check outputs:
( for f in abs_effect.mif beta0.mif beta1.mif cfe.mif std_dev.mif std_effect.mif tvalue.mif Zstat.mif; do testing_diff_image tmp/$f fixelcfestats/masked/$f -abs 1e-6 || exit 1; done ) && mrcalc tmp/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif -abs 1e-6
