# Verify operation of "dwirecon" command for:
# - "combine_pairs" option:
#   identifies volumes with phase encoding equal in readout time but opposing in polarity,
#   and does a weighted recombination of them based on the local Jacobians
# - *Two* input phase encoding directions
#   Use L>>R and R>>L for effects to be more visible pronounced

mrcat \
    $(mrconvert dwirecon/LR_preproc.mif -coord 3 0:6 -) \
    $(mrconvert dwirecon/RL_preproc.mif -coord 3 0:6 -) \
    -axis 3 \
    - | \
dwirecon - combine_pairs \
    -field dwirecon/field.mif \
    - | \
testing_diff_image - dwirecon/combine_pairs/rpepair.mif
